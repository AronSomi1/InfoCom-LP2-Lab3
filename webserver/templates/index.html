<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <title>Drone in Lund</title>
  <script type="text/javascript" src="https://d3js.org/d3.v3.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
  <script type="text/javascript">
    var circle_x = 0;
    var circle_y = 0;
  </script>
  <script type="text/javascript" src="static/js/timer.js"></script> <!-- h채r har vi timern -->
  <script type="text/javascript" src="static/js/timer.js">
  </script>
</head>

<body>
  <div id="timer"></div>
  <form action="javascript:Submit()">
    <label for="fname">From address:</label><br>
    <input type="text" id="faddr" name="faddr"><br>
    <label for="lname">To address:</label><br>
    <input type="text" id="taddr" name="taddr"><br><br>
    <input type="submit" value="Search addresses">
  </form>

  <object id="map" data="static/images/lund-map-v2.svg" type="image/svg+xml"></object>
  <script type="text/javascript" src="static/js/load.js"></script>
  <script>
    var socket = io.connect('http://0.0.0.0:5000')
    socket.on('connect', function () {
      console.log('Successfully connected to server!');
      socket.emit('get_location');
    })
    socket.on('get_location', function (x_data, y_data, minutes, seconds) {
      document.getElementById("timer").innerHTML = 'TimeLeft: ' + minutes + ':' + seconds // this is the timer
      circle_x = x_data;
      circle_y = y_data;
      var doc = document.getElementById('map').getSVGDocument(); //H채mtar Objektet med ID map och dess SVGDocument
      var svg = doc.getElementById("map-svg");    //H채mtar SVG elementet med ID map-svg
      var drone = svg.getElementById('myDrone');  //H채mtar cirkeln med ID myDrone
      console.log(drone)
      if (drone != null) {
        drone.setAttributeNS(null, 'cx', circle_x);
        drone.setAttributeNS(null, 'cy', circle_y);
        drone.setAttributeNS(null, 'fill', 'red');
      }
    })
  </script>
</body>

</html>